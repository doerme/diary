# performance in mobile

依照网上的一个准则, 移动端提出 3 秒完成首屏渲染指标. 然后我看了一下天猫的渲染速度, 他们达到了惊人的小于 554ms 的白屏时间. 天猫的数据量应该比我们的要大得多, 
我看了他们的静态资源请求, 基本都是 200 ok (from cache), 缓存做得非常好, 浏览器直接从 app cache 直接调取静态资源是非常快的.

3G 是移动网络的主流, 所以在优化的时候, 3G 网速肯定是考虑的重中之重. 如果我们将首屏加载的时间设定为 1s 也就是 1000ms, 那么我们能利用的时间就不多了.
DNS 解析时间, DNS 是一个递归的过程, 所以会非常慢, 而且对于移动端来说, 更为严重, TCP 连接时间, HTTP 请求和响应时间. 这些我们能做的不多, 因为 3G 网络的速度就摆在那里.
根据一份报告, 3G DNS 查询要 200ms, TCP 握手要 200ms, HTTP 请求和响应(也就是 TTFB) 为 200ms, 剩下 400ms 给我们优化.

所以服务器返回 html 文档必须在 200ms 以内, 网站的重定向次数应该减到最最最少, 为什么呢? 因为一次重定向就意味着再一次的 DNS 查询, TCP 握手, HTTP 请求, 白白浪费了几百毫秒的
时间, 这样是非常浪费的. 首屏内容应该控制在 14kb 以下, 这样只需要 TCP 一次往返就可以看到内容了(开始渲染).如果遇到非异步的资源请求, 那么就需要停下来下载并执行资源, 所以我们应该
将首屏需要的 js css 资源内联, 但是这样有好有坏, 这样无法缓存资源, 加大了 html 文档的大小, 但是加快了渲染速度.
渲染时间只能预留 200ms.不过这个时间取决于页面的复杂度.